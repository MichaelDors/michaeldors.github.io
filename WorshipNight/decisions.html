<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Worship Night '25</title>
  <meta property="og:image" content="images/worshipnightannouncement.PNG" />
  <meta property="og:title" content="Worship Night" />
  <meta property="og:type" content="website" />
  <meta property="og:description" content="Join us for a night of glorifying God together" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.cdnfonts.com/css/helvetica-neue-55" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
  <link rel="icon" type="image/x-icon" href="images/icon.ico">
  <meta name="theme-color" content="ffc600" />
  <style>
    body { 
        font-family: sans-serif; 
        padding: 1rem; 
        max-width: 600px; 
        margin: auto; 
        background: url('https://michaeldors.com/WorshipNight/images/bg.PNG') no-repeat center center fixed;
        background-size: cover;
        font-family: 'WorshipNight';
    }
    @media (max-width: 768px) {
        body {
            padding: 1rem;
        }
        .formcontainer {
            padding: 30px 20px;
        }
        input, textarea, select {
            width: calc(100% - 30px);
        }
        button {
            width: 100%;
            padding: 1rem 0;
        }
        img {
            width: 100%;
            height: auto;
        }
    }
    input, textarea, select { display: block; width: calc(100% - 40px); margin-bottom: 1rem; padding: 0.5rem; border-radius: 20px; height:20px; background-color: black; color:white; border: none; padding-top:15px; padding-bottom:15px; padding-left:20px;}
    button { padding: 1rem 5rem; background-color: black; border-radius: 20px; color:white; border:none; cursor: pointer; transition: background-color 0.3s;       box-shadow:inset 0 1.54px 0 rgba(255, 255, 255, 0.3), inset 0 -1.3px 0 rgba(0, 0, 0, 0.1);
    }
    button:hover { background-color: #333; }
    .formcontainer{
      background: #ffc600;
      border-radius: 16px;
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
      border: 1px solid rgba(0, 0, 0, 0.3);
      padding:50px;
      padding-top:15px;
      padding-bottom:40px;
      box-shadow:inset 0 1.54px 0 rgba(255, 255, 255, 0.3), inset 0 -1.3px 0 rgba(0, 0, 0, 0.1);
      position: relative;
      transition:0.5s all;
    }
    .progress-bar {
      height: 5px;
      background-color: black;
      transition: width 0.3s ease;
      border-radius: 16px;
      margin-bottom: 20px;
    }
    .form-page {
      display: block;
      opacity: 0;
      transform: translateX(50px);
      transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
      position: absolute;
      width: 100%;
      pointer-events: none;
      visibility: hidden;
    }
    .form-page.active {
      display: block;
      opacity: 1;
      transform: translateX(0);
      position: relative;
      pointer-events: auto;
      visibility: visible;
    }
    .progress-bar {
      height: 5px;
      background-color: black;
      transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      border-radius: 16px;
      margin-bottom: 20px;
    }
    .welcome-page {
      text-align: center;
    }
    .welcome-page h2 {
      font-size: 2em;
      margin-bottom: 1em;
    }

    select{
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      color: #ffffff;
      fill: white;
      background-color: black;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 15px center;
      background-size: 20px;
      padding-right: 45px;
      cursor: pointer;
      transition: all 0.3s ease;
      height: 50px;
      width:calc(100% - 12px);
      border-top-left-radius: 0px;
      border-top-right-radius: 0px;
      border-top:1px solid #ffc600
    }

    select:focus {
      outline: none;
      box-shadow: 0 0 0 2px #ffc600;
    }

    select option {
      background-color: black;
      color: white;
      padding: 12px;
    }
    

    @font-face{
      font-family: 'WorshipNight';
      src: url('https://mailchimp.com/release/plums/ea9371020395bcec.woff2') format('woff2');
    }
  </style>
</head>
<body>
  <img src="images/wordmark.PNG" style="max-width:600px; cursor: pointer;" onclick="window.location.href='index.html'">

  <div class="formcontainer">
    <!-- Welcome Page -->
    <div class="form-page welcome-page active" data-page="1">
      <h2>Welcome!</h2>
      <div class="progress-bar"></div>
      <p style="margin-bottom:40px;">We want to come alongside you in your walk with Christ! Whether you've made a decision or still have questions, we encourage you to reach out and get connected.</p>
      <button type="button" onclick="nextPage(1)">Begin</button>
    </div>

    <!-- Name and Decision Page -->
    <div class="form-page" data-page="2">
      <h2>Gospel Responses</h2>
      <div class="progress-bar"></div>
      <input style="border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; margin-bottom:0px" name="name" placeholder="Your name" required />
      <select name="decision" required>
        <option value="" disabled selected>Select</option>
        <option value="accepted">I have accepted the gospel for the first time</option>
        <option value="rededicated">I have rededicated my life to Christ</option>
        <option value="questions">I still have some questions</option>
      </select>
      <button type="button" onclick="nextPage(2)">Next</button>
    </div>

    <!-- Message Page -->
    <div class="form-page" data-page="3">
      <h2>Tell us about your decision or ask a question!</h2>
      <div class="progress-bar"></div>
      <textarea style="height:100px" name="message" placeholder="Share your story... no matter where you're at" required></textarea>
      <button type="button" onclick="nextPage(3)">Next</button>
    </div>

    <!-- Email Page -->
    <div class="form-page" data-page="4">
      <h2>Stay Connected</h2>
      <div class="progress-bar"></div>
      <p>We'd love to support you on your journey.</p>
      <input type="email" name="email" placeholder="Your email" required />
      <button type="button" onclick="submitForm()">Submit</button>
    </div>

    <!-- Success Page -->
    <div class="form-page" data-page="5">
      <h2>Thank You!</h2>
      <div class="progress-bar"></div>
      <p style="margin-bottom:40px;">We're so excited to walk alongside you as we all grow closer to Christ. We have an amazing team that will be in contact with you soon.</p>
      <button type="button" onclick="resetForm()">Start Over</button>
    </div>
  </div>

  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

    const supabase = createClient(
      'https://edknrdwjvrfpukqkxzlz.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVka25yZHdqdnJmcHVrcWt4emx6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDUwMDg1OTEsImV4cCI6MjA2MDU4NDU5MX0.BgL_N0mFU5RChIRGXNxp89ayrbwhQIVLGcZrn-8DsYQ'
    )

    document.querySelectorAll('.progress-bar').forEach(bar => {
        bar.style.width = `0%`;
      });

    window.nextPage = (currentPage) => {
      const currentElement = document.querySelector(`[data-page="${currentPage}"]`);
      const nextElement = document.querySelector(`[data-page="${currentPage + 1}"]`);
      
      currentElement.classList.remove('active');
      nextElement.classList.add('active');
      
      // Update all progress bars
      const progress = (currentPage) * 20;
      document.querySelectorAll('.progress-bar').forEach(bar => {
        bar.style.width = `${progress}%`;
      });
    };

    window.resetForm = () => {
      document.querySelectorAll('input, textarea, select').forEach(el => el.value = '');
      document.querySelectorAll('.form-page').forEach(page => page.classList.remove('active'));
      document.querySelector('[data-page="1"]').classList.add('active');
      document.querySelectorAll('.progress-bar').forEach(bar => {
        bar.style.width = '0%';
      });
    };

    window.submitForm = async () => {
      const name = document.querySelector('input[name="name"]').value;
      const email = document.querySelector('input[name="email"]').value;
      const message = document.querySelector('textarea[name="message"]').value;
      const decision = document.querySelector('select[name="decision"]').value;

      const { error } = await supabase.from('submissions_decisions').insert([{ name, email, message, decision }]);
      if (error) {
        alert('Error: ' + error.message);
      } else {
        nextPage(4); // Move to success page instead of resetting
      }
    };
  </script>
</body>
</html>
